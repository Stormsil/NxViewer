<Window x:Class="NxTiler.MaskOverlayWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        WindowStyle="None" ResizeMode="NoResize"
        AllowsTransparency="True" Background="Transparent"
        Topmost="True" ShowInTaskbar="False"
        MouseLeftButtonDown="Window_MouseLeftButtonDown"
        MouseLeftButtonUp="Window_MouseLeftButtonUp"
        MouseMove="Window_MouseMove"
        MouseRightButtonUp="Window_MouseRightButtonUp"
        KeyDown="Window_KeyDown">

    <Grid>
        <!-- Border frame (shown during editing, hidden during recording) -->
        <Border x:Name="EditBorder" BorderBrush="#2ecc71" BorderThickness="3" IsHitTestVisible="False"/>

        <!-- Canvas for mask rectangles (alpha=1 needed for hit-testing with AllowsTransparency) -->
        <Canvas x:Name="MaskCanvas" Background="#01000000"/>

        <!-- Status bar at bottom -->
        <Border x:Name="StatusBar" VerticalAlignment="Bottom" HorizontalAlignment="Stretch"
                Background="#CC23282f" Padding="8,4" Margin="3,0,3,3">
            <Grid>
                <TextBlock x:Name="StatusText" Foreground="#e6edf3" FontSize="12"
                           Text="LMB — draw mask. RMB — remove. Enter/F2 — record. Esc — cancel"
                           HorizontalAlignment="Left" VerticalAlignment="Center"/>
                <!-- REC indicator -->
                <StackPanel x:Name="RecIndicator" Orientation="Horizontal" HorizontalAlignment="Right"
                            VerticalAlignment="Center" Visibility="Collapsed">
                    <Ellipse x:Name="RecDot" Width="12" Height="12" Fill="Red" Margin="0,0,6,0" VerticalAlignment="Center"/>
                    <TextBlock x:Name="RecLabel" Text="REC" Foreground="Red" FontSize="14" FontWeight="Bold" VerticalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
